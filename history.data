<wql>-- get pract 100
SELECT * FROM BCSPMP.PRCTNR_T FETCH FIRST 100 ROWS ONLY</wql>
<wql>
-- get pract 10
SELECT * FROM BCSPMP.PRCTNR_T FETCH FIRST 10 ROWS ONLY</wql>
<wql>-- with 50
SELECT * FROM BCSPMP.PRCTNR_T FETCH FIRST 50 ROWS ONLY</wql>
<wql>-- test save
SELECT * FROM BCSPMP.PRCTNR_T FETCH FIRST 2 ROWS ONLY</wql>
<wql>-- teste 13
SELECT * FROM BCSPMP.PRCTNR_T FETCH FIRST 13 ROWS ONLY</wql>
<wql>-- terceiro teste
SELECT
			p.OPPOR_ID as OPPORTUNITY_ID ,
			(RTRIM(PLAN_NM || '|' || char(STAF_PLAN_ID)) || '|' || lob.STAF_PLAN_LOB_CD) as ASSOCIATED_PLANS
			from BCSPMP.STAF_PLAN_T p
			inner join BCSPMP.OPPOR_T o on p.OPPOR_ID = o.OPPOR_ID and p.PLAN_STAT_CD = 'A'
			left outer join bcspmp.STAF_PLAN_LOB_T lob on p.STAF_PLAN_LOB_ID = lob.STAF_PLAN_LOB_ID
			order by p.OPPOR_ID
			fetch first 10 rows only</wql>
<wql>-- TP test
SELECT
		P.FRST_NM as FIRST_NAME, 
		P.MID_NM as MIDDLE_NAME,
		P.PO_NUM as PURCHASE_ORDER_NUMBER, 
		P.LST_NM as LAST_NAME, 
		rtrim(cast(P.PRFSNL_ID as char(40))) as TALENT_POOL_PROFESSIONAL_ID, 
		P.EMAL_ADDR as EMAIL_ADDRESS, 
		P.NOTES_ID,
		P.JOB_RSPNSBLTY, 
		P.WK_PHN_NUM,
		P.MGR_EMAL_ADDR as MANAGER_EMAIL_ADDRESS, 
		(case  P.GBL_RESRC_IND when 'Y' then 'GR' else 'non-GR' end) as RESOURCE_TYPE, 
		(SELECT DPLBLTY_TYP_DESC from TLNTPL.DPLBLTY_TYP_T where DPLBLTY_TYP_CD = p.DPLBLTY_TYP_CD) as DEPLOYABILITY, 
		jf.HRIW_JOB_FMLY_DESC as EXECUTIVE_JOB_ROLE, 
		COALESCE(P.MGR_NOTES_ID,P.MGR_NM,P.MGR_EMAL_ADDR) as MANAGER_NOTES_ID,
		COALESCE(P.RSA_NOTES_ID, 'Unassigned') as RSA_NOTES_ID, 
		T.TLNTPL_ID as TALENT_POOL_ID, 
		T.TLNTPL_NM as TALENT_POOL_NAME, 
		TO.TLNTPL_ORG_NM as TALENT_POOL_ORG, 
		TT.TLNTPL_TYP_DESC as TALENT_POOL_TYPE,
		CASE WHEN lob.LOB_CD IN ('GPS','GPSD') THEN 'GBS' ELSE lob.LOB_CD END as MYSA_TALENT_POOL_LOB,
		CASE WHEN P.DEL_FLG='A'
             AND P.DPLBLTY_TYP_CD = 'F'
             AND MP_VIS_IND = 'V'
             AND (((TO.TLNTPL_ORG_NM like 'GBS%%' OR TO.TLNTPL_ORG_NM like 'GTS IS%%' OR TO.TLNTPL_ORG_NM like 'GPS%%' )
					AND TO.TLNTPL_ORG_NM NOT LIKE '%%Affiliates%%' 
					AND TO.TLNTPL_ORG_NM NOT LIKE '%%ANOB%%' 
					AND TO.TLNTPL_ORG_NM NOT IN ( 
					'GBS Special Terms Employees',
					'GTS IS Other',
					'GTS IS Sales',
					'GTS IS HQ/Top'))
				OR ((TO.TLNTPL_ORG_NM like 'GBS%%' OR TO.TLNTPL_ORG_NM like 'GTS IS%%' OR TO.TLNTPL_ORG_NM like 'GPS%%' ) 
					AND TO.TLNTPL_ORG_NM LIKE '%%Affiliates%%' AND P.LBR_GRP_NM = 'Wholly-owned Affiliates (ILC)'))  
           THEN 1
           ELSE 0
        END AS MYSA_PRCTNR_IND,
		cnt.CNTRY_NM as WORK_LOCATION_COUNTRY, 
		(case TO.TLNTPL_TYP_ID when 3 then P.ISV_VNDR_NM else (SELECT CMPNY_NM FROM TLNTPL.CMPNY_T WHERE SAP_CMPNY_CD = P.SAP_CMPNY_CD) end)  as SAP_COMPANY_NAME, 
		imt.IMT_NM AS WORK_LOCATION_IMT,
		iot.IOT_NM AS WORK_LOCATION_IOT, 
		P.CNUM_ID, 
		P.DIV_CD as DIVISION,
		CASE WHEN (P.DEPT_CD IS NULL OR rTRIM(P.DEPT_CD) = '' ) THEN  'N/A' ELSE P.DEPT_CD END  as DEPARTMENT,
		CASE WHEN (LENGTH(P.EXP_BND_LVL) = 2) AND (SUBSTR(P.EXP_BND_LVL, 2,1) BETWEEN 'A' AND 'Z')  AND (SUBSTR(P.EXP_BND_LVL, 1,1) BETWEEN '0' AND '9') 
		     THEN SUBSTR(P.EXP_BND_LVL,1,1) 
		     ELSE P.EXP_BND_LVL 
		     END AS BAND, 
		CASE WHEN (LENGTH(P.EXP_BND_LVL) = 2 ) AND (SUBSTR(P.EXP_BND_LVL, 2,1) BETWEEN 'A' AND 'Z')  AND (SUBSTR(P.EXP_BND_LVL, 1,1) BETWEEN '0' AND '9') 
		     THEN P.EXP_BND_LVL 
		     ELSE 'N/A' 
		     END AS SUB_BAND,
		P.EXP_BND_LVL as ORIGINAL_BAND,  
		rtrim(P.SERL_NUM) as SERIAL_NUMBER,
		rtrim(COALESCE(P.SERL_NUM, P.ANOB_ID)) as UNHASH_SERIAL_NUMBER, 
		P.PRIM_SCTR_NM as SECTOR, 
		P.PRIM_INDSTR_NM as INDUSTRY, 
		P.SEC_SCTR_NM as SECONDARY_SECTOR, 
		P.SEC_INDSTR_NM as SECONDARY_INDUSTRY,
		P.JOB_TITL_DESC as TITLE, 
		(case when p.MBLTY_IND_DESC is null then 
			'Not specified' else p.MBLTY_IND_DESC end) as MOBILITY_IND,
		DEPT_CAT.DPT_CAT_NM as SERVICE,
		p.SVC_AREA_TYP_DESC as SERVICE_AREA, 
		P.MBL_PHN_NUM as CELL_PHONE,
		P.WRK_CTY_NM as WORK_LOCATION_CITY, 
		P.WRK_STTE_PROV_NM as WORK_LOCATION_STATE,	
		COALESCE(P.WRK_CTY_NM,'N/A') || ', ' || COALESCE(P.WRK_STTE_PROV_NM,'N/A') || ', ' || COALESCE(cnt.CNTRY_NM,'N/A')  as WORK_LOCATION_FULL,
		P.RDM_CMT as RDM_COMMENTS, 
		P.PRPSD_CLNT_TXT as PROPOSED_CUSTOMER, 
		P.AVAIL_DT as AVAILABILITY_DATE,
		P.EMP_TYP_DESC as EMPLOYEE_TYPE_DESC,
		td.RUL_ENGMNT_TXT as RULES_OF_ENGAGEMENT, 
		rtrim(p.ISO_CNTRY_CD) as PRACTITIONER_COUNTRY_CODE, 
		rtrim(P.EMF_CMPNY_CD) as EMF_COMPANY_CODE, 
		(case TO.TLNTPL_TYP_ID when 3 then cast(null as VARCHAR(60)) else P.ISV_VNDR_NM end) as ISV_VENDOR, 
		coalesce(p.CMPTNCY_DESC||' - '||p.CMPTNCY_SEGMT_DESC,p.CMPTNCY_DESC) as COMPETENCY_COMPETENCY_SEGMENT,
		p.CMPTNCY_DESC as COMPETENCY,
		p.CMPTNCY_SEGMT_DESC as COMPETENCY_SEGMENT ,
		CASE WHEN FISCA_FUNC_NM is null AND FISCA_SUB_FUNC_NM is null THEN null ELSE  coalesce(FISCA_FUNC_NM , 'Unknown')||' - '||coalesce(FISCA_SUB_FUNC_NM, 'Unknown') END as FISCA_NAME
		,CASE WHEN teburef.COC_NM is null or trim(teburef.COC_NM)='' THEN 'Not Applicable' ELSE teburef.COC_NM END as COC_NAME
		, (SELECT CAND_PRC_LVL_DESC from BCSPMP.CSA_CAND_PRC_LVL_T where CAND_PRC_LVL_CD = p.CAND_PRC_LVL_CD) as PRICE_LEVEL
		,(case when (exists (SELECT 'Y' from TLNTPL.TLNTPL_T t1, TLNTPL.TLNTPL_ORG_T t2 where t2.TLNTPL_TYP_ID = 3 and t1.TLNTPL_ORG_ID = t2.TLNTPL_ORG_ID and t1.TLNTPL_ID = p.TLNTPL_ID)) then 'Y' else 'N' end) as CONTRACTOR_FLAG
		,P.AVAIL_DT_LCK_FLG as AVAILABILITY_DATE_LOCK_FLAG
		,P.EXT_DT_FLG as EXTENSION_DATE_FLAG
		,P.STAF_REV_NOTES_ID as STAFFING_REVIEWER_NOTES_ID
		FROM 	
		TLNTPL.PRFSNL_T P 
		INNER JOIN TLNTPL.TLNTPL_T T on P.TLNTPL_ID = T.TLNTPL_ID 
		INNER JOIN TLNTPL.TLNTPL_ORG_T TO ON TO.TLNTPL_ORG_ID = T.TLNTPL_ORG_ID 
		INNER JOIN TLNTPL.TLNTPL_TYP_T TT ON TT.TLNTPL_TYP_ID = TO.TLNTPL_TYP_ID
		LEFT JOIN ACLADMIN.LOB_T lob ON lob.LOB_ID = TO.LOB_ID
		LEFT OUTER JOIN TLNTPL.HRIW_JOB_FMLY_T jf on P.HRIW_JOB_FMLY_CD = jf.HRIW_JOB_FMLY_CD
		LEFT OUTER JOIN  TLNTPL.TLNTPL_DPLBLTY_T td on p.TLNTPL_ID = td.TLNTPL_ID and p.DPLBLTY_TYP_CD = td.DPLBLTY_TYP_CD
		LEFT JOIN BCSPMP.CNTRY_T cnt ON cnt.CNTRY_CD = P.ISO_CNTRY_CD 
		LEFT JOIN BCSPMP.IMT_T imt ON imt.IMT_CD = cnt.IMT_CD 
		LEFT JOIN BCSPMP.IOT_T iot ON iot.IOT_CD = imt.IOT_CD 
		LEFT JOIN TLNTPL.EBU_REF_T teburef on p.EBU_CD = teburef.EBU_CD
		LEFT JOIN METRICS.DEPT_CAT_REF_T DEPT_CAT on DEPT_CAT.DPT_CAT_CD = P.SVC_TYP_DESC
		WHERE P.MP_VIS_IND = 'V' and P.DEL_FLG = 'A'
fetch first 10 rows only</wql>
<wql>-- practitioner language
SELECT
		P.PRFSNL_ID as PROFESSIONAL_ID
		,rtrim(P.ISO_CNTRY_CD) as PRACTITIONER_COUNTRY_CODE
		,rtrim(P.EMF_CMPNY_CD) as EMF_COMPANY_CODE
		,rtrim(COALESCE(P.SERL_NUM, P.ANOB_ID)) as UNHASH_SERIAL_NUMBER
		,P.TLNTPL_ID as TALENT_POOL_ID
		,L.LANG_NM as LANGUAGE
		,L.LANG_PRFNCY_LVL_CD as LANGUAGE_PROFICIENCY_LEVEL
		,R.LANG_PRFNCY_DESC as LANGUAGE_PROFICIENCY
		from tlntpl.PRFSNL_T P
		inner join tlntpl.PRFSNL_LANG_T L on L.PRFSNL_ID = P.PRFSNL_ID
		inner join tlntpl.LANG_PRFNCY_LVL_REF_T R on L.LANG_PRFNCY_LVL_CD = R.LANG_PRFNCY_LVL_CD	
		WHERE P.DEL_FLG='A' AND P.MP_VIS_IND='V'
		and L.LANG_PRFNCY_LVL_CD >= 3
		order by 1
		fetch first 10 rows only</wql>
<wql>-- practitioner language
SELECT
		P.PRFSNL_ID as PROFESSIONAL_ID
		,rtrim(P.ISO_CNTRY_CD) as PRACTITIONER_COUNTRY_CODE
		,rtrim(P.EMF_CMPNY_CD) as EMF_COMPANY_CODE
		,rtrim(COALESCE(P.SERL_NUM, P.ANOB_ID)) as UNHASH_SERIAL_NUMBER
		,P.TLNTPL_ID as TALENT_POOL_ID
		,L.LANG_NM as LANGUAGE
		,L.LANG_PRFNCY_LVL_CD as LANGUAGE_PROFICIENCY_LEVEL
		,R.LANG_PRFNCY_DESC as LANGUAGE_PROFICIENCY
		from tlntpl.PRFSNL_T P
		inner join tlntpl.PRFSNL_LANG_T L on L.PRFSNL_ID = P.PRFSNL_ID
		inner join tlntpl.LANG_PRFNCY_LVL_REF_T R on L.LANG_PRFNCY_LVL_CD = R.LANG_PRFNCY_LVL_CD	
		WHERE P.DEL_FLG='A' AND P.MP_VIS_IND='V'
		and L.LANG_PRFNCY_LVL_CD >= 3
		order by 1
		fetch first 10 rows only</wql>
<wql>-- test
SELECT
		P.PRFSNL_ID as PROFESSIONAL_ID
		,rtrim(P.ISO_CNTRY_CD) as PRACTITIONER_COUNTRY_CODE
		,rtrim(P.EMF_CMPNY_CD) as EMF_COMPANY_CODE
		,rtrim(COALESCE(P.SERL_NUM, P.ANOB_ID)) as UNHASH_SERIAL_NUMBER
		,P.TLNTPL_ID as TALENT_POOL_ID
		,L.LANG_NM as LANGUAGE
		,L.LANG_PRFNCY_LVL_CD as LANGUAGE_PROFICIENCY_LEVEL
		,R.LANG_PRFNCY_DESC as LANGUAGE_PROFICIENCY
		from tlntpl.PRFSNL_T P
		inner join tlntpl.PRFSNL_LANG_T L on L.PRFSNL_ID = P.PRFSNL_ID
		inner join tlntpl.LANG_PRFNCY_LVL_REF_T R on L.LANG_PRFNCY_LVL_CD = R.LANG_PRFNCY_LVL_CD	
		WHERE P.DEL_FLG='A' AND P.MP_VIS_IND='V'
		and L.LANG_PRFNCY_LVL_CD >= 3
		order by 1
		fetch first 10 rows only</wql>
<wql>-- test 2
SELECT
		P.PRFSNL_ID as PROFESSIONAL_ID
		,rtrim(P.ISO_CNTRY_CD) as PRACTITIONER_COUNTRY_CODE
		,rtrim(P.EMF_CMPNY_CD) as EMF_COMPANY_CODE
		,rtrim(COALESCE(P.SERL_NUM, P.ANOB_ID)) as UNHASH_SERIAL_NUMBER
		,P.TLNTPL_ID as TALENT_POOL_ID
		,L.LANG_NM as LANGUAGE
		,L.LANG_PRFNCY_LVL_CD as LANGUAGE_PROFICIENCY_LEVEL
		,R.LANG_PRFNCY_DESC as LANGUAGE_PROFICIENCY
		from tlntpl.PRFSNL_T P
		inner join tlntpl.PRFSNL_LANG_T L on L.PRFSNL_ID = P.PRFSNL_ID
		inner join tlntpl.LANG_PRFNCY_LVL_REF_T R on L.LANG_PRFNCY_LVL_CD = R.LANG_PRFNCY_LVL_CD	
		WHERE P.DEL_FLG='A' AND P.MP_VIS_IND='V'
		and L.LANG_PRFNCY_LVL_CD >= 3
		order by 1
		fetch first 10 rows only</wql>
